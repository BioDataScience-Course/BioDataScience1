---
title: "Test t de Student"
author: "Guyliann Engels & Philippe Grosjean"
description: "**SDD I Module 9** La distribution et le test t de Student."
tutorial:
  id: "A09La_ttest"
  version: 2.0.0/9
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
BioDataScience1::learnr_setup()
SciViews::R()
```

```{r, echo=FALSE}
BioDataScience1::learnr_banner()
```

```{r, context="server"}
BioDataScience1::learnr_server(input, output, session)
```

----

## Objectifs

La moyenne est un descripteur tr√®s employ√© pour r√©sumer l'information. Il est tr√®s courant de comparer un moyenne √† une valeurs de r√©f√©rence ou deux moyennes ensembles. Dans votre carri√®re scientifique, il est indispensable de ma√Ætriser la moyenne et ses subtilit√©s.

- Savoir calculer la moyenne, l'√©cart-type ou encore la variance

- Appr√©hender l‚Äôintervalle de confiance, savoir le calculer et l'utiliser

- Comprendre les diff√©rentes variantes du test *t* de Student et √™tre capable de l'utiliser pour r√©soudre des questions pratiques en biologie


## Moyenne

Un √©chantillon repr√©sentatif d'une population peut √™tre d√©crit par plusieurs descripteurs statistiques comme la moyenne, l'√©cart-type ou encore le coefficient de variation.

### Moyenne

Un premier descripteur est donc la moyenne de l'√©chantillon qui est calcul√© via l'√©quation suivante :

$$\bar{x}=\sum_{i=1}^n{\frac{x_i}{n}}$$

En partant de la s√©rie de nombre ci-dessous, r√©alisez les calculs suivants :

```{r, echo = TRUE}
(var <- sample(x = 1:10, size = 3))
```

```{r qu_mean}
question("Calculez la moyenne sur la s√©rie de nombre ci-dessus",
         answer(sprintf("%.2f", mean(var)), correct = TRUE),
         answer(sprintf("%.2f", sum(var))),
         answer(sprintf("%.2f", (mean(var)+1))),
         answer(sprintf("%.2f", (sum(var)/2))),
         allow_retry = TRUE,
         random_answer_order = TRUE,
         incorrect = "Oups, vous avez commis une erreur. Relisez avec attention la formule propos√©e ci-dessus.",
         correct = "Bravo, c'est correct ! Vous savez calculer une moyenne.")
```

### Moyenne du vecteur `vec`

Utilisez une fonction dans R afin de calculer la moyenne du vecteur `vec`.

```{r, echo = TRUE}
vec <- c(14, 24, 32, 18, 19)
```

```{r mean1_h2, exercise = TRUE}
(vec <- c(14, 24, 32, 18, 19))
# Calculez ci-dessous la moyenne de vec

```

```{r mean1_h2-hint-1}
(vec <- c(14, 24, 32, 18, 19))
# Calculez ci-dessous la moyenne de vec : 
# Utilisez la foncion mean()

```

```{r mean1_h2-solution}
(vec <- c(14, 24, 32, 18, 19))
## Solution ##
mean(vec)
```

```{r mean1_h2-check}
grade_result(
  pass_if(~ identical(.result, mean(vec)), "Bien jou√© ! La fonction mean() est la bonne fonction."),
  fail_if(~ TRUE, "Votre calcul n'est pas le bon. Retentez votre chance. R√©fl√©chissez √† la bonne fonction √† employer.")
)
```

### Moyenne du vecteur `vec2`

Utilisez une fonction dans R afin de calculer la moyenne du vecteur `vec2`.

```{r, echo = TRUE}
vec2 <- c(14, 3, 32, NA, 40)
```

```{r mean2_h3, exercise = TRUE}
(vec2 <- c(14, 3, 32, NA, 40))
# Calculez ci-dessous la moyenne de vec

```

```{r mean2_h3-hint-1}
(vec2 <- c(14, 3, 32, NA, 40))
# Calculez ci-dessous la moyenne de vec : 
# Utilisez la foncion mean()

```

```{r mean2_h3-hint-2}
(vec2 <- c(14, 3, 32, NA, 40))
# Calculez ci-dessous la moyenne de vec : 
# Utilisez la foncion mean(), utilisez l'argument na.rm = 

```

```{r mean2_h3-solution}
(vec2 <- c(14, 3, 32, NA, 40))
## Solution ##
mean(vec, na.rm = TRUE)
```

```{r mean2_h3-check}
grade_result(
  pass_if(~ identical(.result, mean(vec2, na.rm = TRUE)), "Bien jou√© ! La fonction mean() est la bonne id√©e. La petite suptilit√© est sur l'utilisation de l'argument na.rm = TRUE."),
  fail_if(~ TRUE, "La bonne id√©e est d'employer la fonction mean(). Il y a une astuce avec les arguments √† employer.")
)
```

### Ecart-type

Un second descripteur d'un √©chantillon est l'√©cart-type qui est calcul√© via l'√©quation suivante :

$$s = \sqrt {s^2}$$

L'√©cart-type est la racine carr√© de la variance qui est √©galement un descripteur statistique de l'√©chantillon. 

La variance de l'√©chantillon qui est calcul√©e via l'√©quation suivante :

$$s^2 = \sum\limits_{i=1}^n \frac{(y_i - \bar y)^2}{n-1}$$

Il existe √©galement des fonctions dans R afin de calculer la variance et l'√©cart-type. Calculez l'√©cart-type du vecteur `vec3`

```{r, echo = TRUE}
vec3 <- c(22, 18, 4, 24, 34, 3, 9)
```

```{r sd1_h2, exercise = TRUE}
vec3 <- c(22, 18, 4, 24, 34, 3, 9)
# Calculez l'√©cart-type

```

```{r sd1_h2-hint-1}
vec3 <- c(22, 18, 4, 24, 34, 3, 9)
# Calculez l'√©cart-type utilisez la fonction sd()
```

```{r sd1_h2-solution}
vec3 <- c(22, 18, 4, 24, 34, 3, 9)
# Calculez l'√©cart-type
sd(vec3)
```

```{r sd1_h2-check}
grade_result(
  pass_if(~ identical(.result, sd(vec3)), "Bien jou√© ! La fonction sd() est la fonction pour calculer l'√©cart-type."),
  fail_if(~ TRUE, "Votre calcul n'est pas le bon. Retentez votre chance. Il semble que vous n'avez pas utilis√© la bonne fonction.")
)
```


### Coefficient de variation 

Un autre descripteur est le coefficient de variation de l'√©chantillon qui est calcul√© via 

$$cv \ (\%) = \frac{s}{\bar y} \times 100$$

Calculez le coefficient de variation du vecteur `vec3`

```{r, echo = TRUE}
vec3 <- c(22, 18, 4, 24, 34, 3, 9)
```

```{r cv1_h2, exercise = TRUE}
vec3 <- c(22, 18, 4, 24, 34, 3, 9)
# Calculez le coefficient de variation 

```

```{r cv1_h2-hint-1}
vec3 <- c(22, 18, 4, 24, 34, 3, 9)
# Calculez le coefficient de variation : utilisez la fonction sd() et la fonction mean
```

```{r cv1_h2-solution}
vec3 <- c(22, 18, 4, 24, 34, 3, 9)
# Calculez l'√©cart-type
sd(vec3)/mean(vec3)*100
```

```{r cv1_h2-check}
grade_result(
  pass_if(~ identical(.result, (sd(vec3)/mean(vec3))*100), "Bien jou√© ! Vous avez judicieusement utilis√© la moyenne et l'√©cart-type pour obtenir le coefficient de variation."),
  fail_if(~ TRUE, "Votre calcul n'est pas le bon. Commencez par d√©terminer la moyenne et l'√©cart-type de ce vecteur. N'oubliez pas de multiplier votre r√©ponse par 100.")
)
```

## Croissance des dents de deux groupes de cochons d'Inde

### Tableau r√©sum√©

![Image par <a href="https://pixabay.com/fr/users/vantagepointfl-55562/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=242520">Vantage Point Graphics</a> de <a href="https://pixabay.com/fr/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=242520">Pixabay</a>](images/guinea-pig.jpg){width=50%}

En partant du jeu de donn√©es propos√© ci-dessous qui porte sur la croissance des dents de cochons d'Inde, reproduisez le tableau ci-dessous.

```{r}
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
# R√©sum√© des donn√©es
tooth_growth %>.%
  group_by(., dose, supp) %>.%
  summarise(., mean = mean(len), sd = sd(len), n = n())
```

Le tableau de donn√©es comprend les variables suivantes : `r colnames(tooth_growth)` 

```{r, echo = TRUE}
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
# Premi√®res lignes du tableau
head(tooth_growth)
```

```{r tab_h2, exercise = TRUE}
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
# R√©sum√© du tableau
tooth_growth %>.%
  ___(., dose,___) %>.%
  summarise(., mean = ___(___), ___ = sd(___), n = n())
```

```{r tab_h2-hint-1}
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
# Tableau
tooth_growth %>.%
  group_by(., dose, ___) %>.%
  summarise(., mean = ___(___), ___ = sd(___), n = n())
```

```{r tab_h2-solution}
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
# tableau
tooth_growth %>.%
  group_by(., dose, supp) %>.%
  summarise(., mean = mean(len), sd = sd(len), n = n())
```

```{r tab_h2-check}
grade_code("Bien jou√© ! Vous avez propos√© un tableau r√©sumant l'information sur la longueur des dents en fonction des doses et des suppl√©ments.", "Analysez avec attention le tableau que vous devez obtenir. Quelle est la variable dont vous devez d√©terminer la moyenne et l'√©cart-type ?")
```

### Test de Student

D√©terminez si la croissance des dents de cochons d'inde est similaire au seuil $\alpha$ de 0.05 lors de l'utilisation du suppl√©ment jus d'orange (OJ) par rapport au suppl√©ment vitamine C (VC). Utilisez un test t de Student bilat√©ral et de variance similaire.

En partant du jeu de donn√©es propos√© ci-dessous qui porte sur la croissance des dents de cochons d'Inde, reproduisez le tableau ci-dessous.

```{r, echo=TRUE}
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
```

Le tableau de donn√©es comprend les variables suivantes : `r colnames(tooth_growth)` 

```{r toothgrowth}
# Importation du jeu de donn√©es ToothGrowth
(tooth_growth <- read("ToothGrowth", package = "datasets"))
# Premi√®res lignes du tableau
head(tooth_growth)
```

üí¨ **Un snippet peut vous aider √† r√©aliser cet exercice `.hmtestindep`.**

```{r ttest_h2, exercise = TRUE, exercise.setup = "toothgrowth"}
.hm
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
# Test de Student
t.test(data = ___, ___ ~ ___,
  alternative = ___, conf.level = ___, var.equal = TRUE)
```

```{r ttest_h2-hint-1}
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
# Test de Student
t.test(data = ___, ___ ~ ___,
  alternative = "two.sided", conf.level = 0.95, var.equal = TRUE)
#### ATTENTION: Hint suivant = solution !####
```

```{r ttest_h2-solution}
# Importation du jeu de donn√©es ToothGrowth
tooth_growth <- read("ToothGrowth", package = "datasets")
# Test de Student
t.test(data = tooth_growth, len ~ supp,
  alternative = "two.sided", conf.level = 0.95, var.equal = TRUE)
```

```{r ttest_h2-check}
grade_code("Bien jou√© ! Vous avez su compl√©ter la fonction t.test().", "Ce n'est pas la bonne r√©ponse. Relis avec attention l'√©nonc√© et compl√®te les √©l√©ments manquants dans cette fonction.")
```

```{r ttest_quiz}
quiz(
  question("Est ce que la croissance des dents de cochons d'Inde est similaire ?",
           answer("oui", correct = TRUE),
           answer("non"),
           allow_retry = TRUE,
           incorrect = "Ce n'est pas la bonne r√©ponse. Vous devez comparer la valeur de p au seuil $\alpha$  d√©fini avant de r√©aliser le test pour trouver la bonne r√©ponse √† cette question.",
           correct = "Bravo, c'est correct. Vous avez bien interpr√©t√© votre test."),
  question("Rejettez vous $H_0$ ?",
           answer("oui"),
           answer("non", correct = TRUE),
           allow_retry = TRUE,
           incorrect = "Vous vous √™tes tromp√©. Pour savoir si vous devez rejeter $H_0*, il faut comparer la valeur de p au seuil $\alpha$  d√©fini avant de r√©aliser le test.",
           correct = "Bravo, c'est correct. Vous ne rejettez pas le $H_0$ au seuil $\alpha$ de 0.05")
)
```

## Conclusion

Bravo! Vous venez de terminer votre s√©ance d'exercices dans un tutoriel "learnr". 

```{r comm_noscore, echo=FALSE}
question_text(
  "Laissez-nous vos impressions sur cet outil p√©dagogique",
  answer("", TRUE, message = "Pas de commentaires... C'est bien aussi."),
  incorrect = "Vos commentaires sont enregistr√©s.",
  placeholder = "Entrez vos commentaires ici...",
  allow_retry = TRUE
)
```

