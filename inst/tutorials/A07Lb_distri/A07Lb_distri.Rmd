---
title: "Distributions"
author: "Guyliann Engels & Philippe Grosjean"
description: "**SDD I Module 7** Distributions binomiale et Poisson."
tutorial:
  id: "A07Lb_distri"
  version: 2.0.0/9
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
BioDataScience1::learnr_setup()
SciViews::R()
```

```{r, echo=FALSE}
BioDataScience1::learnr_banner()
```

```{r, context="server"}
BioDataScience1::learnr_server(input, output, session)
```

----

## Objectifs

Les lois de distribution g√©n√©ralisent le calcul des probabilit√©s dans des situations bien d√©finies. Elles permettent de calculer la probabilit√© que des √©v√®nements se produisent d'un point de vue th√©orique. La distribution binomiale et celle de Poisson concernent des variables quantitatives √† deux modalit√©s, c'est-√†-dire que seulement deux √©v√®nements disjoints peuvent se produire.

- V√©rifiez vos connaissances relatives √† la loi de distribution des probabilit√©s binomiale

- Vous assurez d'avoir bien compris la distribution de Poisson

Vous devez avoir √©tudi√© le contenu du [module 7](https://wp.sciviews.org/sdd-umons/?iframe=wp.sciviews.org/sdd-umons-2020/proba.html) du cours, et en particulier les sections relatives √† la [distribution binomiale](https://wp.sciviews.org/sdd-umons/?iframe=wp.sciviews.org/sdd-umons-2020/distribution-binomiale.html) et √† la [distribution de Poisson](https://wp.sciviews.org/sdd-umons/?iframe=wp.sciviews.org/sdd-umons-2020/distribution-de-poisson.html). Enfin, cette mati√®re n√©cessite que vous soyez √† l'aise avec le calcul des probabilit√©s, et que vous l'ayez v√©rifi√© via le learnr `BioDataScience1::run("A07La_proba")`.

## Distribution binomiale

La distribution binomiale calcule les probabilit√©s de *n* succ√®s pour un mod√®le essai-erreur ind√©pendant. Cela signifie que seulement deux √©v√®nements disjoints sont possibles\ : le "succ√®s" ou l'"√©chec" (ces noms sont attribu√©s aux deux √©v√®nements qui peuvent repr√©senter tout autre chose comme pile ou face, m√¢le ou femelle, chevelu ou non, ...). Le nombre d'essais ind√©pendants *p* est fix√© √† l'avance et est toujours le m√™me pour une distribution donn√©e.

![](images/lions.jpg)

En guise d'entr√©e en mati√®re, r√©pondez aux questions suivantes en effectuant le calcul √† la main (en vous aidant √©ventuellement d'une calculette). Consid√©rant une population de lions dans une r√©serve naturelle au Kenya qui est compos√©e d'autant de lions m√¢les que de lionnes (sexe ratio de 1:1). Vous vous baladez dans la r√©serve et vous avez observ√© dix individus au total.

```{r qu_binom}
quiz(
  question("Calculez la probabilit√© d'avoir observ√© trois m√¢les au maximum.",
    answer("0.117"),
    answer("0.161"), 
    answer("0.172", correct = TRUE),
    answer("0.828"),
    allow_retry = TRUE, random_answer_order = TRUE,
    incorrect = "Recommencez afin de trouver la bonne r√©ponse",
    correct = "C'est correct ! Si l'on consid√®re une distribution al√©atoire des individus dans la r√©serve, du moins, pour cet exemple fictif."),
  question("Calculez la probabilit√© d'observer au minimum quatre m√¢les parmi ces dix individus.",
    answer("0.117"),
    answer("0.161"), 
    answer("0.172"),
    answer("0.828", correct = TRUE),
    allow_retry = TRUE, random_answer_order = TRUE,
    incorrect = "Recommencez afin de trouver la bonne r√©ponse",
    correct = "C'est correct ! Notez que cette probabilit√© est compl√©mentaire √† la pr√©c√©dente.")
)
```

Calculez la table des probabilit√©s possibles pour tous les √©v√®nements depuis z√©ro jusqu'√† dix lions m√¢les observ√©s sur dix individus au total, avec R.

üí¨ **Ce code correspond au snippet `.ibtable`** [`.ib`= (d)istribution: `b`inomial].

```{r binom1_h2, exercise=TRUE}
(.table <- data.frame(success = ___,
    probability = dbinom(___, size = ___, prob = ___)))
```

```{r binom1_h2-hint-1}
(.table <- data.frame(success = 0:10,
    probability = dbinom(0:10, size = ___, prob = ___)))

 #### ATTENTION: Hint suivant = solution !####
```

```{r binom1_h2-solution}
(.table <- data.frame(success = 0:10,
    probability = dbinom(0:10, size = 10, prob = 0.5)))
```

```{r binom1_h2-check}
grade_code("C'est parfait.")
```

Employez R cette fois-ci pour r√©pondre √† une des questions pos√©es lors du quiz plus haut\ : "Calculez la probabilit√© d'observer au maximum 3 m√¢les sur 10 individus."

üí¨ **Ce code correspond au snippet `.ibproba`.**

```{r binom2_h3, exercise=TRUE}
pbinom(___, size = ___, prob = ___, lower.tail = ___)
```

```{r binom2_h3-hint-1}
pbinom(___, size = ___, prob = ___, lower.tail = TRUE)
```

```{r binom2_h3-hint-2}
pbinom(3, size = ___, prob = ___, lower.tail = TRUE)

 #### ATTENTION: Hint suivant = solution !####
```

```{r binom2_h3-solution}
pbinom(3, size = 10, prob = 0.5, lower.tail = TRUE)
```

```{r binom2_h3-check}
grade_code("Vous comprenez manifestement bien la logique de ce type de calcul dans R... ou alors, vous avez pass√© √©norm√©ment de temps √† observer les lions au Kenya !")
```

Calculez avec R la probabilit√© d‚Äôobserver exactement 4 lionnes pour 10 contacts dans une autre r√©serve o√π il y a 3 femelles pour 1 m√¢le (Pr{femelle} = 0.75).

```{r binom3_h3, exercise=TRUE}
pbinom(___, size = ___, prob = ___, lower.tail = ___) - ___
```

```{r binom3_h3-hint-1}
pbinom(___, size = ___, prob = ___, lower.tail = ___) - pbinom(___, size = ___, prob = ___, lower.tail = ___)
```

```{r binom3_h3-hint-2}
pbinom(4, size = ___, prob = ___, lower.tail = TRUE) - pbinom(___, size = ___, prob = ___, lower.tail = TRUE)

 #### ATTENTION: Hint suivant = solution !####
```

```{r binom3_h3-solution}
pbinom(4, size = 10, prob = 0.75, lower.tail = TRUE) - pbinom(3, size = 10, prob = 0.75, lower.tail = TRUE)
```

```{r binom3_h3-check}
grade_code("Comme le calcul des probabilit√©s selon des lois de distribution nous renvoie les probabilit√©s d'√™tre plus petit ou √©gal avec `lower.tail = TRUE` ou plus grand ou √©gale avec `lower.tail = FALSE`, nous devons ruser et soustraire deux probabilit√©s pour avoir un intervalle born√© des deux c√¥t√©s (ou ici, une seule valeur possible).")
```

Repr√©sentez le graphique de densit√© de probabilit√© pour la distribution binomiale de l'exercice pr√©c√©dent.

üí¨ **Ce code correspond au snippet `.ibdens`.**

```{r binom4_h2, exercise=TRUE}
plot(___, dbinom(___, size = ___, prob = ___), type = "h",
  col = "black", xlab = "Quantiles", ylab = "Probability mass")
```

```{r binom4_h2-hint-1}
plot(0:10, dbinom(0:10, size = ___, prob = ___), type = "h",
  col = "black", xlab = "Quantiles", ylab = "Probability mass")

 #### ATTENTION: Hint suivant = solution !####
```

```{r binom4_h2-solution}
plot(0:10, dbinom(0:10, size = 10, prob = 0.75), type = "h",
  col = "black", xlab = "Quantiles", ylab = "Probability mass")
```

```{r binom4_h2-check}
grade_code("Les barres verticales repr√©sentent ici la probabilit√© de chaque √©v√®nement discret correspondant au nombre de succ√®s (les quantiles) en fonction du nombre d'essais ind√©pendants qui est toujours le m√™me (indiqu√© via `size=`).")
```

## Distribution de Poisson

![](images/fishing.jpg)

La distribution de Poisson d√©termine, tout comme la distribution binomiale, les probabilit√©s de nombres de succ√®s par rapport √† un nombre d'essais ind√©pendants, mais ici la probabilit√© de succ√®s est tr√®s faible (√©v√®nement rare). Vous pouvez utiliser cette distribution pour d√©terminer la probabilit√© de rencontrer un animal rare, pour pr√©dire les tremblements de terre, pour d√©terminer la probabilit√© d'une maladie rare, ... et m√™me pour pr√©dire la probabilit√© que vous arriviez √† p√™cher un gros poisson avec votre petite canne √† p√™che\ !

R√©pondez √† la question suivante en effectuant le calcul √† la main (en vous aidant √©ventuellement d'une calculette).

```{r qu_poisson}
quiz(
  question("Calculez le troisi√®me terme d'une distribution de poisson dont le $\\lambda = 3$.",
    answer("0.353"),
    answer("0.647"), 
    answer(" 0.224", correct = TRUE),
    answer("0.828"),
    allow_retry = TRUE, random_answer_order = TRUE,
    incorrect = "Recommencez afin de trouver la bonne r√©ponse",
    correct = "C'est correct !")
)
```

Utilisez R pour repr√©sentez la table de probabilit√©s li√© √† l'exercice ci-dessus.

üí¨ **Ce code correspond au snippet `.iptable`** [`.ip` = (d)`i`stribution: `p`oisson].

```{r poisson1_h2, exercise=TRUE}
(.table <- data.frame(occurences = 0:(___+20), probability = dpois(0:(___+20),
  lambda = ___)))
```

```{r poisson1_h2-hint-1}
(.table <- data.frame(occurences = 0:(3+20), probability = dpois(0:(___+20),
  lambda = ___)))

 #### ATTENTION: Hint suivant = solution !####
```

```{r poisson1_h2-solution}
(.table <- data.frame(occurences = 0:(3+20), probability = dpois(0:(3+20),
  lambda = 3)))
```

```{r poisson1_h2-check}
grade_code("La distribution de Poisson est plus simple que la distribution binomiale car elle n'admet qu'un seul param√®tre, lambda, correspondant au nombre de succ√®s le plus probable.")
```

Repr√©sentez le graphique de densit√© de la distribution de Poisson pour $\lambda = 12$.

üí¨ **Ce code correspond au snippet `.ipdens`.**

```{r poisson2_h2, exercise = TRUE}
plot(0:(___+20), dpois(0:(___+20), lambda = ___),
  type = "h", col = "black", xlab = "Quantiles", ylab = "Probability mass")
```

```{r poisson2_h2-hint-1}
plot(0:(12+20), dpois(0:(___+20), lambda = ___),
  type = "h", col = "black", xlab = "Quantiles", ylab = "Probability mass")

 #### ATTENTION: Hint suivant = solution !####
```

```{r poisson2_h2-solution}
plot(0:(12+20), dpois(0:(12+20), lambda = 12),
  type = "h", col = "black", xlab = "Quantiles", ylab = "Probability mass")
```

```{r poisson2_h2-check}
grade_code("Ce graphique est en fait tr√®s asym√©trique, mais l'axe des quantiles est tronqu√© vers la droite puisque toutes les √©v√®nements avec un plus grand nombre de succ√®s ont tous une probabilit√© tr√®s proche de z√©ro et ne sont donc pas repr√©sent√©s sur le graphique.")
```

## Conclusion

Bravo\ ! Vous venez de terminer votre auto-√©valuation relative √† deux des lois de distribution de probabilit√©s les plus courantes. La logique et la fa√ßon d'effectuer des calculs de probabilit√©s √† partir de quantiles ou de quantiles √† partir de probabilit√©s est un exercice de base en statistiques que vous serez amen√© √† utiliser fr√©quemment. Assurez-vous donc de bien la ma√Ætriser.

```{r comm_noscore, echo=FALSE}
question_text(
  "Laissez-nous vos impressions sur cet outil p√©dagogique",
  answer("", TRUE, message = "Pas de commentaires... C'est bien aussi."),
  incorrect = "Vos commentaires sont enregistr√©s.",
  placeholder = "Entrez vos commentaires ici...",
  allow_retry = TRUE
)
```
