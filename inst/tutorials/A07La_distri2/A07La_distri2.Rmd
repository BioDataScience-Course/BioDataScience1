---
title: "Distributions (suite)"
author: "Guyliann Engels & Philippe Grosjean"
description: "**SDD I Module 7** Distributions binomiale de Poisson, log-normale et graphique quantile-quantile."
tutorial:
  id: "A07La_distri2"
  version: 3.0.0/11
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
BioDataScience1::learnr_setup()
SciViews::R("infer")
# Required for RSConnect
# SciViews::R
library(rlang)
library(data.table)
library(ggplot2)
library(tibble)
library(tidyr)
library(dplyr)
library(dtplyr)
library(broom)
library(forcats)
library(collapse)
library(fs)
library(data.trame)
library(svFast)
library(svTidy)
library(svMisc)
library(svBase)
library(svFlow)
library(data.io)
library(chart)
library(tabularise)
library(SciViews)
# infer section
library(distributional)
library(inferit)
# ... more
library(readxl)
library(testthat)
library(equatags)
library(BioDataScience)
library(BioDataScience1)
```

```{r, echo=FALSE}
BioDataScience1::learnr_banner()
```

```{r, context="server"}
if (Sys.info()["user"] == "rstudio-connect") {
  options(learnr_user_id = session$user)
  assignInNamespace("default_user_id", function() {
    getOption("learnr_user_id", unname(Sys.info()["user"]))
  }, ns = "learnr")
}
BioDataScience1::learnr_server(input, output, session)
```

------------------------------------------------------------------------

## Objectifs

Une loi de distribution statistique g√©n√©ralise le calcul des probabilit√©s dans une situation bien d√©finie. Elle permet de calculer la probabilit√© que des √©v√®nements se produisent d'un point de vue th√©orique. La distribution binomiale et celle de Poisson concernent des variables quantitatives √† deux modalit√©s, c'est-√†-dire que seulement deux √©v√®nements disjoints peuvent se produire.

Parmi les distributions continues, la distribution log-normale est une variante de la distribution normale o√π les quantiles ne peuvent √™tre que nuls ou positifs. Le graphique quantile-quantile est un outil graphique permettant de comparer la distribution d'un √©chantillon √† une distribution th√©orique.

Ce tutoriel est une auto-√©valuation de vos connaissances pour¬†:

-   V√©rifier vos connaissances relatives √† la loi de distribution des probabilit√©s binomiale

-   Vous assurer d'avoir bien compris la distribution de Poisson

-   √ätre certain de bien comprendre le graphique quantile-quantile et l'utiliser pour d√©cider si la distribution d'un √©chantillon suit une distribution normale ou log-normale

Vous devez avoir √©tudi√© le contenu du [module 7](https://wp.sciviews.org/sdd-umons/?iframe=wp.sciviews.org/sdd-umons-2025/districhi2.html) du cours SDD I, et en particulier les sections relatives √† la [distribution binomiale](https://wp.sciviews.org/sdd-umons/?iframe=wp.sciviews.org/sdd-umons-2025/distribution-binomiale.html) et √† la [distribution de Poisson](https://wp.sciviews.org/sdd-umons/?iframe=wp.sciviews.org/sdd-umons-2025/distribution-de-poisson.html), √† la [distribution log-normale](https://wp.sciviews.org/sdd-umons/?iframe=wp.sciviews.org/sdd-umons-2025/distribution-log-normale.html) et au [graphique quantile-quantile](https://wp.sciviews.org/sdd-umons/?iframe=wp.sciviews.org/sdd-umons-2025/graphique-quantile-quantile.html). Enfin, cette mati√®re n√©cessite que vous soyez √† l'aise avec le calcul des probabilit√©s, et que vous l'ayez v√©rifi√© via un tutoriel pr√©c√©dent `BioDataScience1::run("A06La_proba")`.

## Distribution binomiale

La distribution binomiale calcule les probabilit√©s de *n* succ√®s pour un mod√®le essai-erreur ind√©pendant. Cela signifie que seulement deux √©v√®nements disjoints sont possibles¬†: le "succ√®s" ou l'"√©chec" (ces noms sont attribu√©s aux deux √©v√®nements qui peuvent repr√©senter tout autre chose comme pile ou face, m√¢le ou femelle, chevelu ou non ...). Le nombre d'essais ind√©pendants *p* est fix√© √† l'avance et est toujours le m√™me pour une distribution donn√©e.

![](images/lions.jpg)

En guise d'entr√©e en mati√®re, r√©pondez aux questions suivantes en effectuant le calcul √† la main (en vous aidant √©ventuellement d'une calculatrice de poche). Consid√©rant une population de lions dans une r√©serve naturelle au Kenya qui est compos√©e d'autant de lions m√¢les que de lionnes (sexe ratio de 1:1). Vous vous baladez dans la r√©serve et vous avez observ√© dix individus au total (consid√©rez que les individus se r√©partissent al√©atoirement dans la r√©serve, nous savons bien qu'en pratique, ce n'est pas vraiment le cas).

```{r qu_binom}
quiz(
  question("Calculez la probabilit√© d'avoir observ√© trois m√¢les au maximum.",
    answer("0.117"),
    answer("0.161"),
    answer("0.172", correct = TRUE),
    answer("0.828"),
    allow_retry = TRUE, random_answer_order = TRUE,
    incorrect = "Recommencez afin de trouver la bonne r√©ponse.",
    correct = "C'est correct ! Si l'on consid√®re une r√©partition al√©atoire des individus dans la r√©serve, du moins, pour cet exemple fictif. Vous avez fait, par exemple, `pbinom(3, 10, 0.5, lower.tail = TRUE)`."),
  question("Calculez la probabilit√© d'observer au minimum quatre m√¢les parmi ces dix individus.",
    answer("0.117"),
    answer("0.161"),
    answer("0.172"),
    answer("0.828", correct = TRUE),
    allow_retry = TRUE, random_answer_order = TRUE,
    incorrect = "Recommencez afin de trouver la bonne r√©ponse.",
    correct = "C'est correct ! Notez que cette probabilit√© est compl√©mentaire √† la pr√©c√©dente `(1 - P3m)`, avec P3m la probabilit√© d'observer entre 0 et 3 m√¢les calcul√©e juste au dessus.")
)
```

Calculez la table des probabilit√©s possibles pour tous les √©v√®nements depuis z√©ro jusqu'√† dix lions m√¢les observ√©s sur dix individus au total, avec R.

<!-- üí¨ **Ce code correspond au snippet `.ibtable`** [`.ib`= (d)istribution: `b`inomial]. -->

```{r binom1_h2, exercise=TRUE}
(bi_table <- dtx(succ√®s = ___,
    probabilit√© = dbinom(___, size = ___, prob = ___)))
```

```{r binom1_h2-hint-1}
(bi_table <- dtx(succ√®s = 0:10,
    probabilit√© = dbinom(0:10, size = ___, prob = ___)))

 #### ATTENTION: Hint suivant = solution !####
```

```{r binom1_h2-solution}
(bi_table <- dtx(succ√®s = 0:10,
    probabilit√© = dbinom(0:10, size = 10, prob = 0.5)))
```

```{r binom1_h2-check}
grade_code("Oui, `dbinom()` permet de r√©aliser ce calcul. Vous auriez aussi pu utiliser `density(dist_binomial(10, 0.5), 0:10)[[1]]` √† la place.")
```

Utilisez R cette fois-ci, pour r√©pondre √† une des questions pos√©es lors du quiz plus hau¬†: "Calculez la probabilit√© d'observer au maximum 3 m√¢les sur 10 individus", en utilisant `bi <- dist_binomial()`.

<!-- üí¨ **Ce code correspond au snippet `.ibproba`.** -->

```{r binom2_h3, exercise=TRUE}
bi <- dist_binomial(size = ___, prob = ___)
___(bi, q = ___)
```

```{r binom2_h3-hint-1}
bi <- dist_binomial(size = ___, prob = ___)
___(bi, q = 3)
```

```{r binom2_h3-hint-2}
bi <- dist_binomial(size = 10, prob = ___)
___(bi, q = 3)

 #### ATTENTION: Hint suivant = solution !####
```

```{r binom2_h3-solution}
## Solution ##
bi <- dist_binomial(size = 10, prob = 0.5)
cdf(bi, q = 3)
```

```{r binom2_h3-check}
grade_code("Vous comprenez manifestement bien la logique de ce type de calcul dans R... ou alors, vous avez pass√© √©norm√©ment de temps √† observer les lions au Kenya !")
```

Calculez avec R la probabilit√© d'observer exactement 4 lionnes pour 10 contacts dans une autre r√©serve o√π il y a trois femelles pour un m√¢le (Pr{femelle} = 0.75). Vous ferez le calcul en utilisant uniquement `pbinom()`, ce qui vous oblige √† soustraire des aires.

```{r binom3_h3, exercise=TRUE}
pbinom(___, size = ___, prob = ___, lower.tail = ___) -
  ___
```

```{r binom3_h3-hint-1}
pbinom(___, size = ___, prob = ___, lower.tail = ___) -
  pbinom(___, size = ___, prob = ___, lower.tail = ___)
```

```{r binom3_h3-hint-2}
pbinom(4, size = ___, prob = ___, lower.tail = TRUE) -
  pbinom(___, size = ___, prob = ___, lower.tail = TRUE)

 #### ATTENTION: Hint suivant = solution !####
```

```{r binom3_h3-solution}
## Solution ##
pbinom(4, size = 10, prob = 0.75, lower.tail = TRUE) -
  pbinom(3, size = 10, prob = 0.75, lower.tail = TRUE)
```

```{r binom3_h3-check}
grade_code("Comme le calcul de probabilit√© selon des lois de distribution avec les fonctions `pXXX()` nous renvoie la probabilit√© d'√™tre plus petit ou √©gal avec `lower.tail = TRUE` ou plus grand ou √©gal avec `lower.tail = FALSE`, nous devons ruser et soustraire deux probabilit√©s pour avoir un intervalle born√© des deux c√¥t√©s (ou ici, une seule valeur possible). Dans le cas d'une distribution discr√®te et d'un seul √©v√®nement possible, nous avons plus vite fait de d√©terminer directement la densit√© de probabilt√© en ce point avec `dbinom(4, 10, 0.75)` ou `density(dist_binomial(10, 0.75), 4)`. Le calcul que vous venez de faire est toutefois g√©n√©ralisable √† un intervalle de plusieurs √©v√®nements et aussi au cas des distributions continues (cf tutoriel suivant).")
```

Repr√©sentez le graphique de densit√© de probabilit√© pour la distribution binomiale de l'exercice pr√©c√©dent. Dans vos scripts, n'oubliez pas d'utiliser le code suivant avant d'utiliser `chart()`¬†: `SciViews::R("infer")` et `library(BioDataScience1)`.

<!-- üí¨ **Ce code correspond au snippet `.ibdens`.** -->

```{r binom4_h2, exercise=TRUE}
bi <- ___(size = ___, prob = ___)
chart(___) +
  ylab("___")
```

```{r binom4_h2-hint-1}
bi <- dist_binomial(size = ___, prob = ___)
chart(___) +
  ylab("Densit√© de probabilit√©")

 #### ATTENTION: Hint suivant = solution !####
```

```{r binom4_h2-solution}
## Solution ##
bi <- dist_binomial(size = 10, prob = 0.75)
chart(bi) +
  ylab("Densit√© de probabilit√©")
```

```{r binom4_h2-check}
grade_code("Les traits verticaux repr√©sentent ici la probabilit√© de chaque √©v√®nement discret correspondant au nombre de succ√®s (les quantiles) en fonction du nombre d'essais ind√©pendants qui est toujours le m√™me (indiqu√© via `size=`).")
```

## Distribution de Poisson

![](images/fishing.jpg)

La distribution de Poisson d√©termine, tout comme la distribution binomiale, les probabilit√©s de nombres de succ√®s par rapport √† un nombre d'essais ind√©pendants, mais ici la probabilit√© de succ√®s est tr√®s faible (√©v√®nement rare). Vous pouvez utiliser cette distribution pour d√©terminer la probabilit√© de rencontrer un animal rare, pour pr√©dire les tremblements de terre, pour d√©terminer la probabilit√© d'une maladie rare ... et m√™me pour pr√©dire la probabilit√© que vous arriviez √† p√™cher un gros poisson avec votre petite canne √† p√™che¬†!

R√©pondez √† la question suivante en effectuant le calcul √† la main (en vous aidant √©ventuellement d'une calculatrice de poche).

```{r qu_poisson}
quiz(
  question("Calculez le troisi√®me terme d'une distribution de Poisson avec $\\lambda = 3$.",
    answer("0.353"),
    answer("0.647"),
    answer(" 0.224", correct = TRUE),
    answer("0.828"),
    allow_retry = TRUE, random_answer_order = TRUE,
    incorrect = "Recommencez afin de trouver la bonne r√©ponse",
    correct = "C'est correct !")
)
```

Utilisez R pour repr√©senter la table de probabilit√©s li√©e √† l'exercice ci-dessus avec les fonctions p/q/r/d.

<!-- üí¨ **Ce code correspond au snippet `.iptable`** [`.ip` = (d)`i`stribution: `p`oisson]. -->

```{r poisson1_h2, exercise=TRUE}
(poi_table <- dtx(occurences = 0:(___ + 20),
  probabilit√© = dpois(0:(___ + 20), lambda = ___)))
```

```{r poisson1_h2-hint-1}
(poi_table <- dtx(occurences = 0:(3 + 20),
  probabilit√© = dpois(0:(___ + 20), lambda = ___)))

 #### ATTENTION: Hint suivant = solution !####
```

```{r poisson1_h2-solution}
## Solution ##
(poi_table <- dtx(occurences = 0:(3 + 20),
  probabilit√© = dpois(0:(3 + 20), lambda = 3)))
```

```{r poisson1_h2-check}
grade_code("La distribution de Poisson est plus simple que la distribution binomiale car elle n'admet qu'un seul param√®tre, lambda, correspondant au nombre de succ√®s le plus probable.")
```

Repr√©sentez le graphique de densit√© cumul√©e de la distribution de Poisson pour $\lambda = 12$.

<!-- üí¨ **Ce code correspond au snippet `.ipdens`.** -->

```{r poisson2_h2, exercise=TRUE}
poi <- ___(lambda = ___)
___$___(___) +
  ylab("Densit√© de probabilit√© cumul√©e")
```

```{r poisson2_h2-hint-1}
poi <- ___(lambda = ___)
chart$___(poi) +
  ylab("Densit√© de probabilit√© cumul√©e")

 #### ATTENTION: Hint suivant = solution !####
```

```{r poisson2_h2-solution}
## Solution ##
poi <- dist_poisson(lambda = 12)
chart$cumulative(poi) +
  ylab("Densit√© de probabilit√© cumul√©e")
```

```{r poisson2_h2-check}
grade_code("Ce graphique montre que l'on tend, pour les probabilit√©s cumul√©es, tr√®s rapidement vers 1 (pour un quantile aux alentours de 15). Cela signifie que l'on a pratiquement 100% de chances d'observer maximum 15 fois cet √©v√®nement rare durant la p√©riode d'observation d√©finie.")
```

## Graphique quantile-quantile

![](images/crab.jpg)

Utilisez le jeu de donn√©es `crabs` du package {MASS} qui reprend des mesures de la carapace de 200 crabes.

```{r}
SciViews::R("infer")
# Importation des donn√©es
(crabs <- read("crabs", package = "MASS", lang = "fr"))
```

R√©alisez un graphique quantile-quantile visant √† d√©terminer si la longueur de carapace (variable nomm√©e `length`) de ces crabes suit une distribution normale.

<!-- üí¨ **Ce code correspond au snippet `.cuqqnorm`** [`.cu` = `c`hart: `u`nivariate]. -->

```{r qqnorm1_h2, exercise=TRUE}
SciViews::R("infer")
crabs <- read("crabs", package = "MASS", lang = "fr")
car::qqPlot(___[["___"]], distribution = "norm",
  envelope = 0.95, col = "Black", ylab = "Longueur [cm]")
```

```{r qqnorm1_h2-hint-1}
SciViews::R("infer")
crabs <- read("crabs", package = "MASS", lang = "fr")
car::qqPlot(crabs[["___"]], distribution = "norm",
  envelope = 0.95, col = "Black", ylab = "Longueur [cm]")

 #### ATTENTION: Hint suivant = solution !####
```

```{r qqnorm1_h2-solution}
## Solution ##
SciViews::R("infer")
crabs <- read("crabs", package = "MASS", lang = "fr")
car::qqPlot(crabs[["length"]], distribution = "norm",
  envelope = 0.95, col = "Black", ylab = "Longueur [cm]")
```

```{r qqnorm1_h2-check}
grade_code("Rappelez-vous de la syntaxe `DF$VAR` pour se r√©f√©rer √† la variable nomm√©e `VAR` dans le dataframe `DF`. Vous voyez ici que `length` suit une distribution normale parce que tous les points (ou quasi-tous dans d'autres situations) sont √† l'int√©rieur de l'enveloppe de confiance √† 95% repr√©sent√©e par les courbes en pointill√©s bleus.")
```

Est-ce que la longueur de carapace suit une distribution log-normale chez ces m√™mes crabes¬†?

```{r qqnorm2_h2, exercise=TRUE}
SciViews::R("infer")
crabs <- read("crabs", package = "MASS", lang = "fr")
car::qqPlot(___[["___"]], distribution = "___",
  envelope = 0.95, col = "Black", ylab = "Longueur [cm]")
```

```{r qqnorm2_h2-hint-1}
SciViews::R("infer")
crabs <- read("crabs", package = "MASS", lang = "fr")
car::qqPlot(crabs[["___"]], distribution = "lnorm",
  envelope = 0.95, col = "Black", ylab = "Longueur [cm]")

 #### ATTENTION: Hint suivant = solution !####
```

```{r qqnorm2_h2-solution}
## Solution ##
SciViews::R("infer")
crabs <- read("crabs", package = "MASS", lang = "fr")
car::qqPlot(crabs[["length"]], distribution = "lnorm",
  envelope = 0.95, col = "Black", ylab = "Longueur [cm]")
```

```{r qqnorm2_h2-check}
  grade_code("Nous utilisons `distribution = \"norm\"` pour une normale et `distribution = \"lnorm\"` pour une log-normale. Dans le cas pr√©sent, les donn√©es suivent tr√®s clairement une distribution normale. Dans d'autres situations, vous pouvez opter en faveur de la distribution log-normale si les donn√©es n'admettent pas de valeurs n√©gatives (par exemple, des longueurs, des masses ou des concentrations en solution o√π des valeurs n√©gatives sont impossibles)et que le graphique quantile-quantile est en sa faveur, ou √©quivalent entre les deux.")
```

## Conclusion

Bravo¬†! Vous venez de terminer votre auto-√©valuation relative √† deux des lois de distribution de probabilit√©s les plus courantes. La logique et la fa√ßon d'effectuer des calculs de probabilit√©s √† partir de quantiles ou de quantiles √† partir de probabilit√©s est un exercice de base en statistiques que vous serez amen√© √† utiliser fr√©quemment. Assurez-vous donc de bien les ma√Ætriser.

```{r comm_noscore, echo=FALSE}
question_text(
  "Laissez-nous vos impressions sur cet outil p√©dagogique",
  answer("", TRUE, message = "Pas de commentaires... C'est bien aussi."),
  incorrect = "Vos commentaires sont enregistr√©s.",
  placeholder = "Entrez vos commentaires ici...",
  allow_retry = TRUE
)
```

```{css, echo=FALSE}
@media print {
  .topics {
    width: 100% !important;
    padding: 0 0.5em 0 !important;
  }
  .topicsContainer, .topicsContainer *, .learnrBanner, .learnrBanner *, .topicActions, .topicActions * {
    display: none !important;
  }
}
```
